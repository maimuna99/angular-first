{"ast":null,"code":"import { ajax } from 'rxjs/ajax';\nimport { BehaviorSubject, map } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nclass StoreService {\n  constructor() {\n    this.cartItemsSubject = new BehaviorSubject([]);\n    //never expose subjects directly -> use observable\n    this.cartItems$ = this.cartItemsSubject.asObservable();\n    this.producst$ = ajax.getJSON('/assets/data.json');\n    this.total$ = this.cartItems$.pipe(map(products => products.reduce((acc, product) => acc + product.price, 0)));\n  }\n  // addItemToCart(product: Product): void {\n  //   this.cartItemsSubject.next([...this.cartItemsSubject.getValue(), product]);\n  // }\n  // removeItemFromCart(product: Product): void {\n  //   const currentItems = this.cartItemsSubject.getValue();\n  //   const itemIndex = currentItems.findIndex((item) => item.id === product.id);\n  //   if (itemIndex > -1) {\n  //     const updatedItems = [...currentItems];\n  //     updatedItems.splice(itemIndex, 1);\n  //     this.cartItemsSubject.next(updatedItems);\n  //   }\n  // }\n  addItemToCart(product) {\n    const currentItems = this.cartItemsSubject.getValue();\n    const itemIndex = currentItems.findIndex(item => item.product.id === product.id);\n    if (itemIndex > -1) {\n      const updatedItems = [...currentItems];\n      updatedItems[itemIndex].quantity++;\n      this.cartItemsSubject.next(updatedItems);\n    } else {\n      const newItem = {\n        product,\n        quantity: 1\n      };\n      const updatedItems = [...currentItems, newItem];\n      this.cartItemsSubject.next(updatedItems);\n    }\n  }\n  removeItemFromCart(product) {\n    const currentItems = this.cartItemsSubject.getValue();\n    const itemIndex = currentItems.findIndex(item => item.product.id === product.id);\n    if (itemIndex > -1) {\n      const updatedItems = [...currentItems];\n      if (updatedItems[itemIndex].quantity > 1) {\n        updatedItems[itemIndex].quantity--;\n      } else {\n        updatedItems.splice(itemIndex, 1);\n      }\n      this.cartItemsSubject.next(updatedItems);\n    }\n  }\n}\nStoreService.ɵfac = function StoreService_Factory(t) {\n  return new (t || StoreService)();\n};\nStoreService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: StoreService,\n  factory: StoreService.ɵfac,\n  providedIn: 'root'\n});\nexport { StoreService };","map":{"version":3,"names":["ajax","BehaviorSubject","map","StoreService","constructor","cartItemsSubject","cartItems$","asObservable","producst$","getJSON","total$","pipe","products","reduce","acc","product","price","addItemToCart","currentItems","getValue","itemIndex","findIndex","item","id","updatedItems","quantity","next","newItem","removeItemFromCart","splice","factory","ɵfac","providedIn"],"sources":["/Users/maimunawahaibi/Desktop/angular-first/src/app/services/store.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { ajax } from 'rxjs/ajax';\nimport { Observable, BehaviorSubject, map } from 'rxjs';\nimport { Product } from '../interfaces/product.interface';\nimport { scan } from 'rxjs/operators';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class StoreService {\n  private cartItemsSubject = new BehaviorSubject<Product[]>([]);\n\n  //never expose subjects directly -> use observable\n  cartItems$ = this.cartItemsSubject.asObservable();\n  producst$ = ajax.getJSON<Product[]>('/assets/data.json');\n\n  total$ = this.cartItems$.pipe(\n    map((products) => products.reduce((acc, product) => acc + product.price, 0))\n  );\n  // addItemToCart(product: Product): void {\n  //   this.cartItemsSubject.next([...this.cartItemsSubject.getValue(), product]);\n  // }\n  // removeItemFromCart(product: Product): void {\n  //   const currentItems = this.cartItemsSubject.getValue();\n  //   const itemIndex = currentItems.findIndex((item) => item.id === product.id);\n\n  //   if (itemIndex > -1) {\n  //     const updatedItems = [...currentItems];\n  //     updatedItems.splice(itemIndex, 1);\n  //     this.cartItemsSubject.next(updatedItems);\n  //   }\n  // }\n\n  addItemToCart(product: Product): void {\n    const currentItems = this.cartItemsSubject.getValue();\n    const itemIndex = currentItems.findIndex((item) => item.product.id === product.id);\n\n    if (itemIndex > -1) {\n      const updatedItems = [...currentItems];\n      updatedItems[itemIndex].quantity++;\n      this.cartItemsSubject.next(updatedItems);\n    } else {\n      const newItem: cartItem = { product, quantity: 1 };\n      const updatedItems = [...currentItems, newItem];\n      this.cartItemsSubject.next(updatedItems);\n    }\n  }\n\n  removeItemFromCart(product: Product): void {\n    const currentItems = this.cartItemsSubject.getValue();\n    const itemIndex = currentItems.findIndex((item) => item.product.id === product.id);\n\n    if (itemIndex > -1) {\n      const updatedItems = [...currentItems];\n      if (updatedItems[itemIndex].quantity > 1) {\n        updatedItems[itemIndex].quantity--;\n      } else {\n        updatedItems.splice(itemIndex, 1);\n      }\n      this.cartItemsSubject.next(updatedItems);\n    }\n  }\n}\n"],"mappings":"AACA,SAASA,IAAI,QAAQ,WAAW;AAChC,SAAqBC,eAAe,EAAEC,GAAG,QAAQ,MAAM;;AAIvD,MAGaC,YAAY;EAHzBC,YAAA;IAIU,KAAAC,gBAAgB,GAAG,IAAIJ,eAAe,CAAY,EAAE,CAAC;IAE7D;IACA,KAAAK,UAAU,GAAG,IAAI,CAACD,gBAAgB,CAACE,YAAY,EAAE;IACjD,KAAAC,SAAS,GAAGR,IAAI,CAACS,OAAO,CAAY,mBAAmB,CAAC;IAExD,KAAAC,MAAM,GAAG,IAAI,CAACJ,UAAU,CAACK,IAAI,CAC3BT,GAAG,CAAEU,QAAQ,IAAKA,QAAQ,CAACC,MAAM,CAAC,CAACC,GAAG,EAAEC,OAAO,KAAKD,GAAG,GAAGC,OAAO,CAACC,KAAK,EAAE,CAAC,CAAC,CAAC,CAC7E;;EACD;EACA;EACA;EACA;EACA;EACA;EAEA;EACA;EACA;EACA;EACA;EACA;EAEAC,aAAaA,CAACF,OAAgB;IAC5B,MAAMG,YAAY,GAAG,IAAI,CAACb,gBAAgB,CAACc,QAAQ,EAAE;IACrD,MAAMC,SAAS,GAAGF,YAAY,CAACG,SAAS,CAAEC,IAAI,IAAKA,IAAI,CAACP,OAAO,CAACQ,EAAE,KAAKR,OAAO,CAACQ,EAAE,CAAC;IAElF,IAAIH,SAAS,GAAG,CAAC,CAAC,EAAE;MAClB,MAAMI,YAAY,GAAG,CAAC,GAAGN,YAAY,CAAC;MACtCM,YAAY,CAACJ,SAAS,CAAC,CAACK,QAAQ,EAAE;MAClC,IAAI,CAACpB,gBAAgB,CAACqB,IAAI,CAACF,YAAY,CAAC;KACzC,MAAM;MACL,MAAMG,OAAO,GAAa;QAAEZ,OAAO;QAAEU,QAAQ,EAAE;MAAC,CAAE;MAClD,MAAMD,YAAY,GAAG,CAAC,GAAGN,YAAY,EAAES,OAAO,CAAC;MAC/C,IAAI,CAACtB,gBAAgB,CAACqB,IAAI,CAACF,YAAY,CAAC;;EAE5C;EAEAI,kBAAkBA,CAACb,OAAgB;IACjC,MAAMG,YAAY,GAAG,IAAI,CAACb,gBAAgB,CAACc,QAAQ,EAAE;IACrD,MAAMC,SAAS,GAAGF,YAAY,CAACG,SAAS,CAAEC,IAAI,IAAKA,IAAI,CAACP,OAAO,CAACQ,EAAE,KAAKR,OAAO,CAACQ,EAAE,CAAC;IAElF,IAAIH,SAAS,GAAG,CAAC,CAAC,EAAE;MAClB,MAAMI,YAAY,GAAG,CAAC,GAAGN,YAAY,CAAC;MACtC,IAAIM,YAAY,CAACJ,SAAS,CAAC,CAACK,QAAQ,GAAG,CAAC,EAAE;QACxCD,YAAY,CAACJ,SAAS,CAAC,CAACK,QAAQ,EAAE;OACnC,MAAM;QACLD,YAAY,CAACK,MAAM,CAACT,SAAS,EAAE,CAAC,CAAC;;MAEnC,IAAI,CAACf,gBAAgB,CAACqB,IAAI,CAACF,YAAY,CAAC;;EAE5C;;AApDWrB,YAAY,C;mBAAZA,YAAY;AAAA;AAAZA,YAAY,C;SAAZA,YAAY;EAAA2B,OAAA,EAAZ3B,YAAY,CAAA4B,IAAA;EAAAC,UAAA,EAFX;AAAM;SAEP7B,YAAY"},"metadata":{},"sourceType":"module","externalDependencies":[]}